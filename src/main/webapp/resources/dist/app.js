define("pages/service",["require"],function(e){return function(e){e.service("cache",function(){var e={};this.set=function(t,n){e[t]=n},this.get=function(t){return e[t]}}),e.factory("validatePattern",function(){return{bankCard:function(e){if(e.length<16||e.length>19)return!1;var t=/^\d*$/;if(!t.exec(e))return!1;var n="10,18,30,35,37,40,41,42,43,44,45,46,47,48,49,50,51,52,53,54,55,56,58,60,62,65,68,69,84,87,88,94,95,98,99";if(n.indexOf(e.substring(0,2))==-1)return!1;var r=e.substr(e.length-1,1),i=e.substr(0,e.length-1),s=new Array;for(var o=i.length-1;o>-1;o--)s.push(i.substr(o,1));var u=[],a=[],f=new Array;for(var l=0;l<s.length;l++)(l+1)%2==1?parseInt(s[l])*2<9?u.push(parseInt(s[l])*2):a.push(parseInt(s[l])*2):f.push(s[l]);var c=[],h=[];for(var p=0;p<a.length;p++)c.push(parseInt(a[p])%10),h.push(parseInt(a[p])/10);var d=0,v=0,m=0,g=0,y=0;for(var b=0;b<u.length;b++)d+=parseInt(u[b]);for(var w=0;w<f.length;w++)v+=parseInt(f[w]);for(var E=0;E<c.length;E++)m+=parseInt(c[E]),g+=parseInt(h[E]);y=parseInt(d)+parseInt(v)+parseInt(m)+parseInt(g);var S=parseInt(y)%10==0?10:parseInt(y)%10,x=10-S;return r==x?!0:!1},idcard:function(e){function t(e){e=s(e.replace(/ /g,""));if(e.length==15)return i(e);if(e.length==18){var t=e.split("");return r(e)&&n(t)?!0:!1}return!1}function n(e){var t=0;e[17].toLowerCase()=="x"&&(e[17]=10);for(var n=0;n<17;n++)t+=o[n]*e[n];return valCodePosition=t%11,e[17]==u[valCodePosition]?!0:!1}function r(e){var t=e.substring(6,10),n=e.substring(10,12),r=e.substring(12,14),i=new Date(t,parseFloat(n)-1,parseFloat(r));return i.getFullYear()!=parseFloat(t)||i.getMonth()!=parseFloat(n)-1||i.getDate()!=parseFloat(r)?!1:!0}function i(e){var t=e.substring(6,8),n=e.substring(8,10),r=e.substring(10,12),i=new Date(t,parseFloat(n)-1,parseFloat(r));return i.getYear()!=parseFloat(t)||i.getMonth()!=parseFloat(n)-1||i.getDate()!=parseFloat(r)?!1:!0}function s(e){return e.replace(/(^\s*)|(\s*$)/g,"")}var o=[7,9,10,5,8,4,2,1,6,3,7,9,10,5,8,4,2,1],u=[1,0,10,9,8,7,6,5,4,3,2];return t(e)}}})}}),define("pages/filter",[],function(){return function(e){}}),define("common/js/baseUrl/baseUrl",[],function(){return"./"}),define("pages/directive",["require","iScroll","hammer","angular","../common/js/baseUrl/baseUrl"],function(e){var t=e("iScroll"),n=e("hammer"),r=e("angular"),i=e("../common/js/baseUrl/baseUrl");return function(e){e.directive("tap",function(){return function(e,t,r,i){var s=new n(t[0]);s.on("tap",function(){e.$apply(r.tap),t.attr("href")&&t.attr("href")!="javascript:;"&&(location.href=r.href)})}}),e.directive("formValidated",function(){return{restrict:"A",require:"^?form",link:function(e,t,n,r){var i=t[0];t.on("submit",function(){var t=!1;for(var s=0;s<i.length;s++){var o=i[s].name;o&&r[o]&&r[o].$invalid&&(t=!0,r[o].$pristine=!1)}return t?e.$apply():e.$apply(n.formValidated),!1})}}}),e.directive("doValidate",function(){return{restrict:"A",require:"^?form",link:function(e,t,r,i){var s=new n(t[0]);s.on("tap",function(){var n=!1;e.isDisabled=!1;var s=r.doValidate;s&&i[s]&&(i[s].$invalid?(n=!0,i[s].$pristine=!1,t.attr("is-disabled","true")):t.attr("is-disabled","false"));if(n)return e.$apply(),!1})}}}),e.directive("bankCard",["validatePattern",function(e){return{restrict:"A",scope:!0,require:"ngModel",link:function(t,n,r,i){i.$parsers.unshift(function(t){t=t.replace(/\D/g,"");var r="";for(var s=0;s<t.length;s++)s>3&&s%4==0&&(r+=" "),r+=t.charAt(s);return n.val(r),e.bankCard(t)?(i.$setValidity("bankCard",!0),t):(i.$setValidity("bankCard",!1),undefined)})}}}]),e.directive("idcard",["validatePattern",function(e){return{restrict:"A",scope:!0,require:"ngModel",link:function(t,n,r,i){i.$parsers.unshift(function(t){t=t.replace(/\D/g,"");var r="";for(var s=0;s<t.length;s++)s>3&&(s+2)%4==0&&(r+=" "),r+=t.charAt(s);return n.val(r),e.idcard(t)?(i.$setValidity("idcard",!0),t):(i.$setValidity("idcard",!1),undefined)})}}}]),e.directive("phone",function(){return{restrict:"A",scope:!0,require:"ngModel",link:function(e,t,n,r){r.$parsers.unshift(function(e){e=e.replace(/\D/g,"");var n="";for(var i=0;i<e.length;i++)i>0&&(i+1)%4==0&&(n+=" "),n+=e.charAt(i);return t.val(n),/^1[345678]\d{9}$/.test(e)?(r.$setValidity("phone",!0),e):(r.$setValidity("phone",!1),undefined)})}}}),e.directive("checkVerifyCode",["cache",function(e){var t=60;return e.set("timer",t),{restrict:"A",scope:!0,require:"^?form",link:function(r,i,s,o){function u(){i.html(f+"秒");var n=setInterval(function(){f--;if(f<0){f=t,e.set("timer",f),i.html(a),clearInterval(n),n=null;return}i.html(f+"秒"),e.set("timer",f)},1e3)}var a=i.html(),f=e.get("timer");f!==t&&u();var l=new n(i[0]);l.on("tap",function(){if(f!==t)return;var e=s.doValidate;e&&o[e]?o[e].$invalid||(r.$apply(s.checkVerifyCode),u()):(r.$apply(s.checkVerifyCode),u())})}}}]),e.directive("repeatKey",function(){return{require:"ngModel",link:function(e,t,n,r){var i=t.inheritedData("$formController")[n.repeatKey];r.$parsers.push(function(e){if(e===i.$viewValue)return r.$setValidity("repeatKey",!0),e;r.$setValidity("repeatKey",!1)}),i.$parsers.push(function(e){return r.$setValidity("repeatKey",e===r.$viewValue),e})}}}),e.directive("iscroll",["$parse",function(e){return{link:function(n,i,s){function o(){var t=e(s.pagination)(n);typeof t=="function"&&t.call(n,f)}var u=new t(i[0],{probeType:2,scrollbars:!0,fadeScrollbars:!0,shrinkScrollbars:"clip"});i[0].children[0].style.minHeight=i[0].offsetHeight+1+"px";var a=!0,f=1,l=0,c=null;if(s.pagination){var h=r.element('<div class="update-prompt update-prompt-up"></div>'),p=r.element('<div class="update-prompt update-prompt-down"></div>');n.$watch(s.currentPage,function(t){if(t===undefined){h.addClass("hidden"),p.addClass("hidden");return}h.removeClass("hidden"),p.removeClass("hidden"),h.removeClass("update-loading"),p.removeClass("update-loading"),f=t,l=e(s.pages)(n),l>1&&a&&(a=!1,i.children().eq(0).addClass("pagination-content"),i.append(h),i.append(p))}),n.$watch(s.pages,function(e){l=e||0}),u.on("scroll",function(){f===1?h.addClass("hidden"):h.removeClass("hidden"),f===l?p.addClass("hidden"):p.removeClass("hidden"),this.y>40?(c="down",h.text("正在刷新"),h.addClass("update-loading")):this.y-this.maxScrollY<-40?(c="up",p.text("正在加载"),p.addClass("update-loading")):c=null}),u.on("scrollEnd",function(){if(c){if(c=="up"){if(f==l)return;p.text(""),h.text(""),p.removeClass("update-loading"),f++}if(c=="down"){if(f==1)return;h.text(""),p.text(""),h.removeClass("update-loading"),f--}o()}c=null})}s.iscroll.split(";").forEach(function(e){n.$watch(e,function(){setTimeout(function(){u.refresh(),u.scrollTo(0,0)},200)})})}}}]),e.directive("modal",function(){return{restrict:"A",link:function(e,t,n){var r=!1;t.on("webkitTransitionEnd transitionend",function(){!r&&t.css("display","none")}),e.$watch(n.modal,function(e){r=e,e?(t.css("display","block"),setTimeout(function(){t.addClass("modal-show")},0)):t.removeClass("modal-show")})}}}),e.directive("testCode",["$http","$state","$parse","baseUrl",function(e,t,r,i){var s=!0;return{restrict:"A",link:function(e,i,o){s=!0;var u=!1,a=new n(i[0]);a.on("tap",function(){var n=r(o.verifyCodeState)(e);if(n)t.go(o.targetPage,r(o.stateParams)(e));else{e.$apply(o.testCode);if(u)return;u=!0;var i=e.$watch(o.verifyCodeState,function(n){n&&s&&(i(),s=!1,t.go(o.targetPage,r(o.stateParams)(e)))})}return!1})}}}]),e.directive("cancelBubble",function(){return{restrict:"A",link:function(e,t,r){var i=new n(t[0]);i.on("tap",function(e){e.srcEvent.stopPropagation(),e.cancelBubble=!0})}}}),e.directive("backPage",["$state","$stateParams",function(e,t){return{restrict:"A",link:function(r,i,s){var o=new n(i[0]);o.on("tap",function(){history.length>1?history.back():e.go(s.backPage,t)})}}}])}}),define("pages/home/home",["require","../../common/js/baseUrl/baseUrl"],function(e){var t=e("../../common/js/baseUrl/baseUrl");return function(e){e.controller("homeControl",["$scope","$http","$state",function(e,n,r){e.params={isAccept:!0},e.submit=function(){n({url:t+"customer/saveCustomerLoan",method:"post",data:e.params}).success(function(e){if(e.success){if(e.data=="exist"){r.go("registed");return}r.go("register")}else alert(e.msg)})},e.getVerifyCode=function(){n({url:t+"sms/sendVerificationCode",method:"post",data:{cellPhone:e.params.cellPhone}}).success(function(e){e.success||alert(e.msg)})}}])}}),define("pages/register/register",["require","../../common/js/baseUrl/baseUrl"],function(e){var t=e("../../common/js/baseUrl/baseUrl");return function(e){e.controller("registerControl",["$scope","$http","$state",function(e,n,r){e.params={},e.submit=function(){n({url:t+"customer/saveOrUpdateCustomer",method:"post",data:e.params}).success(function(e){e.success?r.go("registerInfo"):alert(e.msg)})}}])}}),define("pages/registerInfo/registerInfo",["require","../../common/js/baseUrl/baseUrl"],function(e){var t=e("../../common/js/baseUrl/baseUrl");return function(e){e.controller("registerInfoControl",["$scope","$http","$state","cache",function(e,n,r,i){var s=["@qq.com","@163.com","@126.com","@139.com","@sina.com","@hotmail.com","@aliyun.com","@sohu.com"];e.params={},e.isShowSuffix=!1,e.emailList=s,e.isEmail=!0,e.addSuffix=function(t){e.params.email+=t,e.isShowSuffix=!1,e.isEmail=!0},e.testSuffix=function(t){if(!t){e.isShowSuffix=!1;return}var n=(t||"").indexOf("@");if(n==-1)e.emailList=s,e.isShowSuffix=!0;else{var r=[],i=new RegExp("^"+t.substring(n,t.length));s.forEach(function(e){i.test(e)&&r.push(e.replace(i,""))}),e.emailList=r,e.isShowSuffix=!!r.length}},e.submit=function(){if(!/^[^\s@]+@[^\s@]+\.\S+$/.test(e.params.email)){e.isEmail=!1;return}n({url:t+"customer/saveOrUpdateCustomerPersonal",method:"post",data:e.params}).success(function(e){if(e.success){if(e.data.account){i.set("account",e.data.account),r.go("login");return}r.go("registed")}else alert(e.msg)})}}])}}),define("pages/registed/registed",[],function(){return function(e){e.controller("registedControl",["$scope","$http",function(e,t){}])}}),define("pages/login/login",["require","../../common/js/baseUrl/baseUrl"],function(e){var t=e("../../common/js/baseUrl/baseUrl");return function(e){e.controller("loginControl",["$scope","$http","$state","cache",function(e,n,r,i){e.params={account:i.get("account")},e.submit=function(){n({url:t+"index/loginSite",method:"post",data:e.params}).success(function(e){e.success?(i.set("validaty",e.data),r.go("validaty")):alert(e.msg)})}}])}}),define("pages/validaty/validaty",["require","../../common/js/baseUrl/baseUrl"],function(e){var t=e("../../common/js/baseUrl/baseUrl");return function(e){e.controller("validatyControl",["$scope","$http","$state","cache",function(e,n,r,i){e.params={},e.submit=function(){var s=i.get("validaty")||{};angular.extend(s,e.params),n({url:t+"index/validateCode",method:"post",data:s}).success(function(e){e.success?r.go("registed"):alert(e.msg)})}}])}}),define("app",["require","angular","ui.router","angular.animate","angular.sanitize","angular.messages","./pages/service","./pages/filter","./pages/directive","./pages/home/home","./pages/register/register","./pages/registerInfo/registerInfo","./pages/registed/registed","./pages/login/login","./pages/validaty/validaty"],function(e){var t=e("angular");e("ui.router"),e("angular.animate"),e("angular.sanitize"),e("angular.messages");var n=t.module("app",["ui.router","ngSanitize","ngAnimate","ngMessages"]);n.config(["$stateProvider","$urlRouterProvider","$httpProvider",function(n,r,i){i.defaults.headers.post["Content-Type"]="application/x-www-form-urlencoded;charset=UTF-8",i.defaults.transformRequest=function(e){if(t.isObject(e)){var n=[];for(var r in e)e[r]&&n.push(r+"="+e[r]);return n.join("&")}},r.when("","/home"),n.state("home",{url:"/home",templateUrl:e.toUrl("./pages/home/home.html"),controller:"homeControl"}).state("register",{url:"/register",templateUrl:e.toUrl("./pages/register/register.html"),controller:"registerControl"}).state("registerInfo",{url:"/registerInfo",templateUrl:e.toUrl("./pages/registerInfo/registerInfo.html"),controller:"registerInfoControl"}).state("registed",{url:"/registed",templateUrl:e.toUrl("./pages/registed/registed.html"),controller:"registedControl"}).state("certificate",{url:"/certificate",templateUrl:e.toUrl("./pages/article/certificate.html")}).state("manageService",{url:"/manageService",templateUrl:e.toUrl("./pages/article/manageService.html")}).state("login",{url:"/login",templateUrl:e.toUrl("./pages/login/login.html"),controller:"loginControl"}).state("validaty",{url:"/validaty",templateUrl:e.toUrl("./pages/validaty/validaty.html"),controller:"validatyControl"})}]),e("./pages/service")(n),e("./pages/filter")(n),e("./pages/directive")(n),e("./pages/home/home")(n),e("./pages/register/register")(n),e("./pages/registerInfo/registerInfo")(n),e("./pages/registed/registed")(n),e("./pages/login/login")(n),e("./pages/validaty/validaty")(n),t.element(document).ready(function(){function o(){i||(e.style.display="none")}var e=document.getElementById("alert"),r=e.className,i=!1,s=null;window.alert=function(t,n){e.style.display="block",setTimeout(function(){e.className=r+" modal-show",i=!0},0),e.getElementsByTagName("p")[0].innerText=t,s=n},e.getElementsByTagName("button")[0].onclick=function(){i=!1,e.className=r,s&&s(),s=null},e.addEventListener("webkitTransitionEnd",o),e.addEventListener("transitionend",o);var u=document.body;window.prompt=function(e){function s(){u.removeChild(t),t=n=r=null}var t=document.createElement("div");u.appendChild(t),t.className="prompt-msg",t.innerHTML='<div class="prompt"><p class="text-overflow fl"></p></div>';var n=t.getElementsByTagName("p")[0],r=t.getElementsByTagName("div")[0];n.innerText=e;var i=n.offsetWidth;r.style.width=i+"px",r.style.marginLeft=i/-2+"px",t.addEventListener("webkitAnimationEnd",s),t.addEventListener("animationend",s)};var a=document.getElementById("page-wrap");n.run(["$rootScope","$location","$state",function(e,t,n){e.$on("$stateChangeStart",function(e,t,n,r,i){var s={home:{register:"slideInRight slideOutLeft",certificate:"slideInRight slideOutLeft",manageService:"slideInRight slideOutLeft"},register:{home:"slideInLeft slideOutRight",registerInfo:"slideInRight slideOutLeft"},registerInfo:{register:"slideInLeft slideOutRight",registed:"slideInRight slideOutLeft",login:"slideInRight slideOutLeft"},login:{registerInfo:"slideInLeft slideOutRight",validaty:"slideInRight slideOutLeft"},validaty:{login:"slideInLeft slideOutRight"},registed:{registerInfo:"slideInLeft slideOutRight"},certificate:{home:"slideInLeft slideOutRight"},manageService:{home:"slideInLeft slideOutRight"}},o=s[r.name]||"";o=o[t.name]||"",a.className="page-wrap animated ui-view-container "+o})}]),t.bootstrap(document,["app"])})});
